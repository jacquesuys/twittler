<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="moment.min.js" defer></script>
  </head>
  <body>
    <div class="tweets">
      <!-- Tweets go here -->
    </div>
    <script>

      $(document).ready(function() {
        var $tweets = $('.tweets');
        var $tweet, $html, $moment, $hashtags, tweet;

        var hashTagger = function(match) {
          return '<span class="hashtag">' + match + '</span>';
        };

        var buildTweets = function() {
          $tweets.html('');

          var index = streams.home.length - 1;
          while(index >= 0){
            // vars
            tweet = streams.home[index];
            $moment = moment(tweet.created_at).fromNow();
            $text = tweet.message;
            $text = $text.charAt(0).toUpperCase() + $text.substring(1);
            $text = $text.replace(/#(.+?)(?=[\s.,:,]|$)/, hashTagger);
            $html = '';
            $tweet = $('<div class="tweet"></div>');

            // build html
            $html += '<a href="#" class="user">';
            $html += '<strong>' + tweet.user + '</strong> ';
            $html += '<span class="handle">@' + tweet.user + '</span>';
            $html += '</a>';
            $html += ' . <span class="timestamp">' + $moment + '</span>';
            $html += '<p>' + $text + '</p>';

            // append html
            $tweet.html($html);
            $tweet.appendTo($tweets);

            index -= 1;
          }
        };

        buildTweets();

      });

    </script>
  </body>
</html>
